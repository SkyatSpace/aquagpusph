<?xml version="1.0" ?>

<!-- deltaSPH-simple.xml
Add the simplest correction to the Laplacian of the pressure computation, based
on the hypothesis that the linear part of the pressure field is equal to the
hydrostatic component.
-->

<sphInput>
    <Variables>
        <Variable name="lap_p_corr" type="vec*" length="N" />
    </Variables>

    <Tools>
        <Tool name="cfd lap p simple" action="insert" before="cfd lap p" type="kernel" entry_point="simple" path="@RESOURCES_OUTPUT_DIR@/Scripts/cfd/deltaSPH.cl"/>
        <!-- Correct the Laplacian of the pressure. This operation is a bit
        special, because we should grant that lap_p_corr computation has
        finished. So it is more convenient to do that after the Interactions
        stage. This tool is signaling other modules where they should add
        tools: After this tool to use lap_p_corr (e.g. in a BC) -->
        <Tool name="LapP Correction" action="insert" after="Interactions" type="kernel" entry_point="lapp_corr" path="@RESOURCES_OUTPUT_DIR@/Scripts/cfd/deltaSPH.cl"/>
        <!-- Dummy tool to signal other modules where they should add tools:
        Before this tool to modify lap_p_corr -->
        <Tool name="LapP Correction MLS" action="insert" after="Interactions" type="dummy"/>
    </Tools>
</sphInput>
